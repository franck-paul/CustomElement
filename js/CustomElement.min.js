class DotclearRest{servicesUri="index.php?rest&";constructor(){this.servicesUri=(e=>{let t={};const s=document.getElementById(`${e}-data`);if(s)try{t=JSON.parse(s.textContent)}catch(e){}return t})("custom-element").uri}run(e,t=e=>{},s=e=>{console.log(e)},n={}){const o=new URL(this.servicesUri,globalThis.location.origin+globalThis.location.pathname);n.f=e;const r=new URLSearchParams(n);o.search+=r.toString(),fetch(o,{method:"GET"}).then(e=>{if(!e.ok)throw new Error(e.statusText);return e.text()}).then(e=>t(e)).catch(e=>s(e))}}class DotclearReleaseStableVersion extends HTMLElement{constructor(){super();const e=new DotclearRest;e&&e.run("getReleaseStableVersion",e=>{const t=JSON.parse(e);if(!t?.success||!t?.payload.ret)return;const s=this.attachShadow({mode:"open"}),n=document.createElement("span");n.textContent=t.payload.text,s.appendChild(n)},e=>{},{json:1})}}customElements.define("dotclear-release-stable-version",DotclearReleaseStableVersion);
