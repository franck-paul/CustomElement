class DotclearRest{servicesUri="index.php?rest&";constructor(){this.servicesUri=(e=>{const t=document.getElementById(`${e}-data`);if(t)try{return JSON.parse(t.textContent)}catch(e){console.log(e)}return{}})("custom-element").uri}run(e,t=e=>{},s=e=>{console.log(e)},r={}){const n=new URL(this.servicesUri,globalThis.location.origin+globalThis.location.pathname);r.f=e;const o=new URLSearchParams(r);n.search+=o.toString(),fetch(n,{method:"GET"}).then(e=>{if(!e.ok)throw new Error(e.statusText);return e.text()}).then(e=>t(e)).catch(e=>s(e))}}class DotclearRestFetch{constructor(e){this.fn=e}run(e){const t=new DotclearRest;t&&t.run(this.fn,t=>{const s=JSON.parse(t);if(!s?.success||!s?.payload.ret)return;const r=e.attachShadow({mode:"open"}),n=document.createElement("span");n.textContent=s.payload.text,r.appendChild(n)},e=>{},{json:1})}}class DotclearReleaseStableVersion extends HTMLElement{constructor(){super(),new DotclearRestFetch("getReleaseStableVersion").run(this)}}class DotclearReleaseStablePhpMin extends HTMLElement{constructor(){super(),new DotclearRestFetch("getReleaseStablePhpMin").run(this)}}class DotclearNextRequiredPhp extends HTMLElement{constructor(){super(),new DotclearRestFetch("getNextRequiredPhp").run(this)}}customElements.define("dotclear-release-stable-version",DotclearReleaseStableVersion),customElements.define("dotclear-release-stable-phpmin",DotclearReleaseStablePhpMin),customElements.define("dotclear-next-required-php",DotclearNextRequiredPhp);
